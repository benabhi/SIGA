<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIGA | Sistema Integral</title>

    <!-- FUENTES -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@800;900&display=swap"
        rel="stylesheet">

    <!-- ICONOS -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

    <!-- ESTILOS -->
    <link rel="stylesheet" href="styles.css">

    <!-- VUE 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- TAILWIND CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        siga: {
                            blue: { dark: '#1F4E79', mid: '#2E75B6', light: '#5B9BD5' },
                            orange: '#FF6600',
                            text: { dark: '#1e293b', light: '#64748B' },
                            bg: '#F8FAFC',
                            danger: { DEFAULT: '#EF4444', light: '#FEF2F2' },
                            success: { DEFAULT: '#10B981', light: '#DCFCE7' },
                            warning: { DEFAULT: '#F59E0B', light: '#FEF3C7' }
                        }
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'], brand: ['Montserrat', 'sans-serif'] },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards',
                        'shake': 'shake 0.4s linear',
                        'pulse-blue': 'pulseBlue 1.5s infinite',
                        'fade-in': 'fadeIn 0.3s ease-out forwards',
                    },
                    keyframes: {
                        fadeInUp: { '0%': { opacity: '0', transform: 'translateY(15px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        shake: { '0%, 100%': { transform: 'translateX(0)' }, '10%, 30%, 50%, 70%, 90%': { transform: 'translateX(-5px)' }, '20%, 40%, 60%, 80%': { transform: 'translateX(5px)' } },
                        pulseBlue: { '0%': { boxShadow: '0 0 0 0 rgba(46,117,182,0.4)' }, '70%': { boxShadow: '0 0 0 6px rgba(46,117,182,0)' }, '100%': { boxShadow: '0 0 0 0 rgba(46,117,182,0)' } }
                    }
                }
            }
        }
    </script>

    <style>
        [v-cloak] {
            display: none !important;
        }

        body {
            background-color: #F8FAFC;
            margin: 0;
            font-family: 'Inter', sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        .collapsible-form-container {
            overflow: hidden;
            max-height: 0;
            opacity: 0;
            transform: translateY(-10px);
            transition: max-height 0.5s cubic-bezier(0.33, 1, 0.68, 1), opacity 0.5s cubic-bezier(0.33, 1, 0.68, 1), transform 0.5s cubic-bezier(0.33, 1, 0.68, 1);
        }

        .collapsible-form-container.open {
            max-height: 600px;
            opacity: 1;
            transform: translateY(0);
        }

        .pattern-grid {
            background-image: radial-gradient(rgba(255, 255, 255, 0.15) 1.5px, transparent 1.5px);
            background-size: 40px 40px;
        }

        .async-node-wrapper {
            position: relative;
            display: inline-block;
        }

        .async-node-wrapper::after {
            content: attr(data-label);
            position: absolute;
            bottom: 130%;
            left: 50%;
            transform: translateX(-50%) translateY(5px);
            background: #1E293B;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.2s ease-out;
            z-index: 50;
            box-shadow: 0 4px 10px -1px rgba(0, 0, 0, 0.2);
        }

        .async-node-wrapper::before {
            content: '';
            position: absolute;
            bottom: 120%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #1E293B transparent transparent transparent;
            opacity: 0;
            transition: all 0.2s ease-out;
            transform: translateY(5px);
            pointer-events: none;
            z-index: 49;
        }

        .async-node-wrapper:hover::after,
        .async-node-wrapper:hover::before {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
    </style>
</head>

<body class="font-sans text-siga-text-dark">

    <div id="app" v-cloak>

        <!-- ========================================== -->
        <!-- MODALES (POP-UPS) -->
        <!-- ========================================== -->

        <!-- MODAL DETALLE ALUMNO (MODIFICADO CON EMAIL, FECHA Y LINK) -->
        <div v-if="isModalOpen && modalType === 'alumno'"
            class="fixed inset-0 z-[60] flex items-center justify-center px-4 animate-fade-in">
            <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" @click="closeModal"></div>
            <div
                class="bg-white rounded-xl shadow-2xl w-full max-w-2xl relative z-10 overflow-hidden transform transition-all">
                <div class="bg-siga-blue-dark p-6 flex justify-between items-center">
                    <h3 class="text-white font-brand font-bold text-xl m-0 flex items-center gap-2"><i
                            class="ri-file-search-line"></i> Detalle de Solicitud</h3>
                    <button @click="closeModal" class="text-white/70 hover:text-white transition-colors"><i
                            class="ri-close-line text-2xl"></i></button>
                </div>
                <div class="p-8" v-if="modalData">
                    <div class="flex gap-6 items-start">
                        <div
                            class="w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center text-2xl font-bold text-siga-blue-mid border-2 border-white shadow-md shrink-0">
                            {{ modalData.nombre.charAt(0) }}</div>
                        <div class="flex-1">
                            <h2 class="text-xl font-bold text-siga-blue-dark mb-1">{{ modalData.nombre }}</h2>
                            <p class="text-siga-text-light mb-4 text-sm"><i class="ri-mail-line"></i> {{ modalData.email
                                }}</p>

                            <!-- GRID INFO ACTUALIZADO -->
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div class="bg-gray-50 p-3 rounded-lg border border-gray-100"><span
                                        class="block text-xs font-bold text-gray-400 uppercase mb-1">DNI</span><span
                                        class="font-mono font-semibold text-gray-700">{{ modalData.dni }}</span></div>
                                <div class="bg-gray-50 p-3 rounded-lg border border-gray-100"><span
                                        class="block text-xs font-bold text-gray-400 uppercase mb-1">Estado</span><span
                                        class="text-siga-success font-bold flex items-center gap-1"><i
                                            class="ri-checkbox-circle-line"></i> {{ modalData.estado }}</span></div>

                                <!-- NUEVO: Fecha de Alta -->
                                <div class="bg-gray-50 p-3 rounded-lg border border-gray-100"><span
                                        class="block text-xs font-bold text-gray-400 uppercase mb-1">Fecha de
                                        Alta</span><span class="font-mono font-semibold text-gray-700">{{
                                        modalData.fechaSolicitud }}</span></div>

                                <!-- NUEVO: Enlace a Legajo -->
                                <div class="bg-gray-50 p-3 rounded-lg border border-gray-100 flex items-center">
                                    <button v-if="modalData.estado === 'Aprobado'" @click="goToLegajo(modalData)"
                                        class="text-siga-blue-mid hover:text-siga-blue-dark hover:underline font-bold text-xs flex items-center gap-2 transition-colors w-full">
                                        <i class="ri-external-link-line text-lg"></i> IR AL LEGAJO PERSONAL
                                    </button>
                                    <span v-else class="text-xs text-gray-400 italic">Legajo no generado</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 pt-6 border-t border-gray-100">
                        <h4 class="text-sm font-bold text-siga-text-dark mb-4">Proceso de Alta y Notificación</h4>
                        <div class="flex items-center justify-between px-4 relative">
                            <div class="absolute left-0 right-0 top-1/2 h-1 bg-gray-100 -z-10"></div>

                            <!-- Pasos (1, 2, 3 y el NUEVO 4) -->
                            <div class="flex flex-col items-center gap-2 bg-white px-2">
                                <div class="w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all"
                                    :class="getNodeClass(modalData.pasos.db)"><i
                                        :class="getNodeIcon(modalData.pasos.db)"></i></div><span
                                    class="text-xs font-semibold text-gray-500">Datos</span>
                            </div>
                            <div class="flex flex-col items-center gap-2 bg-white px-2">
                                <div class="w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all"
                                    :class="getNodeClass(modalData.pasos.moodle)"><i
                                        :class="getNodeIcon(modalData.pasos.moodle)"></i></div><span
                                    class="text-xs font-semibold text-gray-500">Moodle</span>
                            </div>
                            <div class="flex flex-col items-center gap-2 bg-white px-2">
                                <div class="w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all"
                                    :class="getNodeClass(modalData.pasos.sage)"><i
                                        :class="getNodeIcon(modalData.pasos.sage)"></i></div><span
                                    class="text-xs font-semibold text-gray-500">SAGE</span>
                            </div>

                            <!-- NUEVO PASO EMAIL -->
                            <div class="flex flex-col items-center gap-2 bg-white px-2">
                                <div class="w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all"
                                    :class="getNodeClass(modalData.pasos.email)"><i
                                        :class="getNodeIcon(modalData.pasos.email)"></i></div><span
                                    class="text-xs font-semibold text-gray-500">Email</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 p-4 flex justify-end gap-3 border-t border-gray-100">
                    <button @click="closeModal"
                        class="px-4 py-2 bg-siga-blue-dark text-white rounded-lg text-sm font-semibold hover:bg-siga-blue-mid transition-colors">Cerrar</button>
                </div>
            </div>
        </div>

        <!-- MODAL NUEVO DOCENTE -->
        <div v-if="isModalOpen && modalType === 'new_docente'"
            class="fixed inset-0 z-[60] flex items-center justify-center px-4 animate-fade-in">
            <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" @click="closeModal"></div>
            <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg relative z-10 overflow-hidden">
                <div class="bg-siga-blue-dark p-5 flex justify-between items-center">
                    <h3 class="text-white font-bold text-lg m-0">Registrar Nuevo Docente</h3>
                    <button @click="closeModal" class="text-white/70 hover:text-white"><i
                            class="ri-close-line text-2xl"></i></button>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Nombre y Apellido</label>
                        <input v-model="newDocente.nombre" type="text" class="w-full p-2 border rounded-lg text-sm"
                            placeholder="Ej: Juan Pérez">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-1">DNI</label>
                        <input v-model="newDocente.dni" type="text" class="w-full p-2 border rounded-lg text-sm"
                            placeholder="Ej: 12345678">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Email</label>
                        <input v-model="newDocente.email" type="email" class="w-full p-2 border rounded-lg text-sm"
                            placeholder="Ej: docente@instituto.edu.ar">
                    </div>
                    <div class="bg-blue-50 p-3 rounded text-xs text-siga-blue-dark">
                        <i class="ri-information-line"></i> Podrá asignar materias a este docente una vez creado.
                    </div>
                </div>
                <div class="bg-gray-50 p-4 flex justify-end gap-2 border-t">
                    <button @click="closeModal"
                        class="px-4 py-2 text-sm text-gray-600 font-bold hover:bg-gray-200 rounded-lg">Cancelar</button>
                    <button @click="saveDocente"
                        class="px-4 py-2 text-sm text-white bg-siga-orange font-bold hover:bg-orange-600 rounded-lg">Guardar</button>
                </div>
            </div>
        </div>

        <!-- MODAL ASIGNAR DOCENTE -->
        <div v-if="isModalOpen && modalType === 'assign_docente'"
            class="fixed inset-0 z-[60] flex items-center justify-center px-4 animate-fade-in">
            <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" @click="closeModal"></div>
            <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg relative z-10 overflow-hidden">
                <div class="bg-siga-blue-dark p-5 flex justify-between items-center">
                    <h3 class="text-white font-bold text-lg m-0">Asignar Docente a Materia</h3>
                    <button @click="closeModal" class="text-white/70 hover:text-white"><i
                            class="ri-close-line text-2xl"></i></button>
                </div>
                <div class="p-6">
                    <div class="mb-4" v-if="!fixedContextDocente">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Docente</label>
                        <select v-model="assignData.docenteId" class="w-full p-2 border rounded-lg text-sm">
                            <option value="">Seleccione Docente...</option>
                            <option v-for="d in docentesData" :key="d.id" :value="d.id">{{ d.nombre }} ({{ d.dni }})
                            </option>
                        </select>
                    </div>
                    <div class="mb-4" v-if="!fixedContextCarrera">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Carrera</label>
                        <select v-model="assignData.carreraId" class="w-full p-2 border rounded-lg text-sm"
                            @change="assignData.materiaId = ''">
                            <option value="">Seleccione Carrera...</option>
                            <option v-for="c in carrerasData" :key="c.id" :value="c.id">{{ c.nombre }}</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Materia</label>
                        <select v-model="assignData.materiaId" class="w-full p-2 border rounded-lg text-sm"
                            :disabled="!assignData.carreraId">
                            <option value="">Seleccione Materia...</option>
                            <option v-for="m in getMateriasByCarrera(assignData.carreraId)" :key="m.id" :value="m.id">{{
                                m.n }} ({{ m.t }})</option>
                        </select>
                    </div>
                </div>
                <div class="bg-gray-50 p-4 flex justify-end gap-2 border-t">
                    <button @click="closeModal"
                        class="px-4 py-2 text-sm text-gray-600 font-bold hover:bg-gray-200 rounded-lg">Cancelar</button>
                    <button @click="confirmAssignment"
                        class="px-4 py-2 text-sm text-white bg-siga-blue-mid font-bold hover:bg-blue-600 rounded-lg">Asignar</button>
                </div>
            </div>
        </div>

        <!-- MODAL NUEVA/EDITAR MATERIA -->
        <div v-if="isModalOpen && modalType === 'new_materia'"
            class="fixed inset-0 z-[60] flex items-center justify-center px-4 animate-fade-in">
            <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" @click="closeModal"></div>
            <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg relative z-10 overflow-hidden">
                <div class="bg-siga-blue-dark p-5 flex justify-between items-center">
                    <h3 class="text-white font-bold text-lg m-0">{{ isEditingMateria ? 'Editar Materia' : 'Agregar
                        Materia' }}</h3>
                    <button @click="closeModal" class="text-white/70 hover:text-white"><i
                            class="ri-close-line text-2xl"></i></button>
                </div>
                <div class="p-6">
                    <p class="text-sm text-gray-500 mb-4">Plan de: <strong>{{ selectedCarrera?.nombre }}</strong></p>
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Nombre de la Materia</label>
                        <input v-model="newMateria.nombre" type="text" class="w-full p-2 border rounded-lg text-sm">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Régimen</label>
                        <select v-model="newMateria.tipo" class="w-full p-2 border rounded-lg text-sm">
                            <option value="Anual">Anual</option>
                            <option value="Cuatrimestral">Cuatrimestral</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Correlativas Requeridas</label>
                        <div class="max-h-32 overflow-y-auto border rounded-lg p-2 bg-gray-50">
                            <div v-if="availableCorrelatives.length === 0" class="text-xs text-gray-400 italic">No hay
                                materias disponibles para correlatividad.</div>
                            <label v-for="mat in availableCorrelatives" :key="mat.id"
                                class="flex items-center gap-2 text-sm mb-1 cursor-pointer hover:bg-gray-100 p-1 rounded">
                                <input type="checkbox" :value="mat.id" v-model="newMateria.correlativas">
                                <span class="text-gray-700">{{ mat.n }}</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 p-4 flex justify-end gap-2 border-t">
                    <button @click="closeModal"
                        class="px-4 py-2 text-sm text-gray-600 font-bold hover:bg-gray-200 rounded-lg">Cancelar</button>
                    <button @click="saveMateria"
                        class="px-4 py-2 text-sm text-white bg-siga-blue-mid font-bold hover:bg-blue-600 rounded-lg">{{
                        isEditingMateria ? 'Guardar Cambios' : 'Agregar' }}</button>
                </div>
            </div>
        </div>

        <!-- VISTA 1: LOGIN -->
        <div v-if="currentView === 'login'"
            class="flex min-h-screen w-full bg-white flex-col lg:flex-row overflow-hidden">
            <div class="relative bg-siga-blue-dark w-full lg:flex-1 shrink-0 z-10">
                <div class="pattern-grid absolute inset-0 z-0"></div>
                <div
                    class="relative z-10 flex flex-col justify-center items-center text-center lg:items-start lg:text-left h-[40vh] lg:h-screen lg:sticky lg:top-0 p-8 lg:p-20 text-white">
                    <div class="font-brand text-sm lg:text-lg uppercase tracking-widest opacity-70 mb-2">Instituto CENT
                        N° 40</div>
                    <div
                        class="font-brand text-7xl sm:text-8xl lg:text-9xl font-black leading-none mb-6 -tracking-[4px]">
                        SIGA<span class="text-siga-orange ml-1">.</span></div>
                    <div
                        class="text-lg lg:text-2xl font-light opacity-90 max-w-[500px] leading-relaxed lg:border-l-4 border-siga-orange lg:pl-6 hidden lg:block">
                        Gestión Académica Integral</div>
                    <div class="text-base font-light opacity-90 lg:hidden">Gestión Académica Integral</div>
                    <div class="hidden lg:grid mt-16 gap-5 opacity-80">
                        <div class="flex items-center gap-4 text-lg font-medium"><i
                                class="ri-checkbox-circle-line text-siga-orange"></i> Legajo Digital Unificado</div>
                        <div class="flex items-center gap-4 text-lg font-medium"><i
                                class="ri-checkbox-circle-line text-siga-orange"></i> Integración con SAGE</div>
                        <div class="flex items-center gap-4 text-lg font-medium"><i
                                class="ri-checkbox-circle-line text-siga-orange"></i> Autogestión de Alumnos</div>
                    </div>
                </div>
            </div>

            <div
                class="flex flex-col justify-center p-8 lg:p-12 bg-white relative z-20 w-full lg:w-[500px] lg:flex-none shrink-0 lg:border-l border-siga-text-light/20 min-h-[60vh] lg:min-h-screen -mt-10 lg:mt-0 rounded-t-[30px] lg:rounded-none shadow-[0_-10px_30px_rgba(0,0,0,0.1)] lg:shadow-none overflow-y-auto">
                <div class="text-center lg:text-left mb-8">
                    <h2 class="text-3xl lg:text-4xl text-siga-blue-dark mb-2 font-extrabold font-brand">Acceder</h2>
                    <p class="text-siga-text-light">Seleccione su perfil para continuar</p>
                </div>
                <div class="grid grid-cols-2 gap-3 transition-all duration-300" :class="{'mb-5': activeForm !== null}">
                    <div @click="seleccionarRol('aspirante')"
                        class="border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 flex flex-col items-center gap-2 group"
                        :class="getRoleClass('aspirante')"><i class="ri-user-add-line text-2xl transition-colors"
                            :class="rolSeleccionado === 'aspirante' ? 'text-siga-orange' : 'text-siga-blue-mid'"></i><span
                            class="font-bold text-xs uppercase tracking-wide">Aspirante</span></div>
                    <div @click="seleccionarRol('alumno')"
                        class="border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 flex flex-col items-center gap-2 group"
                        :class="getRoleClass('alumno')"><i class="ri-book-open-line text-2xl transition-colors"
                            :class="rolSeleccionado === 'alumno' ? 'text-siga-orange' : 'text-siga-blue-mid'"></i><span
                            class="font-bold text-xs uppercase tracking-wide">Estudiante</span></div>
                    <div @click="seleccionarRol('docente')"
                        class="border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 flex flex-col items-center gap-2 group"
                        :class="getRoleClass('docente')"><i class="ri-presentation-line text-2xl transition-colors"
                            :class="rolSeleccionado === 'docente' ? 'text-siga-orange' : 'text-siga-blue-mid'"></i><span
                            class="font-bold text-xs uppercase tracking-wide">Docente</span></div>
                    <div @click="seleccionarRol('admin')"
                        class="border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 flex flex-col items-center gap-2 group"
                        :class="getRoleClass('admin')"><i class="ri-building-4-line text-2xl transition-colors"
                            :class="rolSeleccionado === 'admin' ? 'text-siga-orange' : 'text-siga-blue-mid'"></i><span
                            class="font-bold text-xs uppercase tracking-wide">Secretaría</span></div>
                </div>
                <div class="collapsible-form-container" :class="{'open': activeForm === 'login'}">
                    <div class="pt-6 border-t border-gray-100 animate-fade-in-up">
                        <div class="mb-5 text-siga-blue-dark">
                            <strong class="text-lg">Ingreso <span class="capitalize">{{ nombreRolDisplay
                                    }}</span></strong>
                            <p class="text-sm text-siga-text-light mt-1">Ingrese sus credenciales institucionales.</p>
                        </div>
                        <form @submit.prevent="login()">
                            <div class="mb-4"><label
                                    class="block text-sm font-semibold text-siga-text-dark mb-2">Usuario</label><input
                                    type="text" v-model="loginData.user"
                                    class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:border-siga-blue-mid focus:ring-4 focus:ring-siga-blue-mid/10 transition-all text-sm"
                                    :class="{'border-siga-danger bg-siga-danger-light animate-shake': authError}"
                                    @input="authError = false" placeholder="Ingrese usuario"></div>
                            <div class="mb-4"><label
                                    class="block text-sm font-semibold text-siga-text-dark mb-2">Contraseña</label><input
                                    type="password" v-model="loginData.pass"
                                    class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:border-siga-blue-mid focus:ring-4 focus:ring-siga-blue-mid/10 transition-all text-sm"
                                    :class="{'border-siga-danger bg-siga-danger-light animate-shake': authError}"
                                    @input="authError = false" placeholder="••••••••"><span v-if="authError"
                                    class="text-siga-danger text-xs mt-1 block font-medium">Credenciales
                                    incorrectas.</span></div>
                            <div class="flex justify-between items-center mb-6 text-sm"><label
                                    class="flex items-center gap-2 cursor-pointer text-siga-text-light"><input
                                        type="checkbox"
                                        class="rounded border-gray-300 text-siga-blue-mid focus:ring-siga-blue-mid">
                                    Recordarme</label><a href="#" @click.prevent="cambiarFormulario('recovery')"
                                    class="text-siga-blue-mid font-semibold hover:underline">¿Olvidó su contraseña?</a>
                            </div>
                            <button type="submit"
                                class="w-full p-3.5 bg-siga-orange text-white rounded-lg font-semibold text-base flex justify-center items-center gap-2 hover:bg-orange-600 hover:-translate-y-px transition-all shadow-md"
                                :class="{'animate-shake': authError}"><span v-if="!cargandoLogin">INGRESAR AL
                                    SISTEMA</span><span v-else><i class="ri-loader-4-line animate-spin"></i>
                                    Verificando...</span></button>
                        </form>
                    </div>
                </div>
                <div class="collapsible-form-container" :class="{'open': activeForm === 'recovery'}">
                    <div class="pt-6 border-t border-gray-100 animate-fade-in-up">
                        <div class="mb-5 text-siga-blue-dark"><strong class="text-lg">Recuperar Cuenta</strong>
                            <p class="text-sm text-siga-text-light mt-1">Le enviaremos un enlace de restablecimiento.
                            </p>
                        </div>
                        <form @submit.prevent="enviarRecuperacion">
                            <div class="mb-4"><label class="block text-sm font-semibold text-siga-text-dark mb-2">Correo
                                    Electrónico</label><input type="email"
                                    class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:border-siga-blue-mid focus:ring-4 focus:ring-siga-blue-mid/10 transition-all text-sm"
                                    placeholder="nombre@instituto.edu.ar" required></div>
                            <div class="text-right mb-4"><a href="#" @click.prevent="cambiarFormulario('login')"
                                    class="text-siga-text-light text-sm flex items-center justify-end gap-1 hover:text-siga-blue-mid"><i
                                        class="ri-arrow-left-line"></i> Volver al Inicio</a></div><button type="submit"
                                class="w-full p-3.5 bg-siga-blue-mid text-white rounded-lg font-semibold text-base flex justify-center items-center gap-2 hover:bg-siga-blue-dark transition-all shadow-md"><span
                                    v-if="!recuperacionEnviada">ENVIAR ENLACE</span><span v-else><i
                                        class="ri-check-line"></i> ENVIADO</span></button>
                        </form>
                    </div>
                </div>
                <div class="mt-auto pt-8 text-center text-xs text-siga-text-light">&copy; 2025 CENT N° 40 - R.N.</div>
            </div>
        </div>

        <!-- VISTA 2: LAYOUT APP -->
        <div v-if="currentView === 'app'" class="flex h-screen bg-siga-bg overflow-hidden relative">

            <!-- MOBILE OVERLAY -->
            <div v-if="mobileMenuOpen" @click="mobileMenuOpen = false"
                class="fixed inset-0 bg-black/50 z-40 lg:hidden transition-opacity"></div>

            <!-- SIDEBAR -->
            <aside
                class="w-64 bg-white border-r border-gray-200 flex flex-col shrink-0 fixed inset-y-0 left-0 z-50 shadow-2xl lg:shadow-none lg:static transform transition-transform duration-300"
                :class="mobileMenuOpen ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'">
                <div
                    class="h-[70px] flex items-center pl-6 border-b border-gray-200 font-brand font-black text-xl tracking-tight text-siga-blue-dark">
                    SIGA<span class="text-siga-orange ml-0.5">.</span></div>
                <ul class="flex-1 p-4 space-y-1 overflow-y-auto">
                    <template v-if="rolSeleccionado === 'aspirante'">
                        <li><a
                                class="flex items-center gap-3 px-4 py-3 rounded-lg bg-siga-blue-dark text-white font-medium cursor-pointer"><i
                                    class="ri-file-list-3-line text-lg"></i> Preinscripción</a></li>
                        <li><a
                                class="flex items-center gap-3 px-4 py-3 rounded-lg text-siga-text-light hover:bg-gray-50 hover:text-siga-blue-dark transition-colors font-medium cursor-pointer"><i
                                    class="ri-question-line text-lg"></i> Ayuda</a></li>
                    </template>
                    <template v-if="rolSeleccionado === 'admin'">
                        <li><a @click="changeAdminView('dashboard')"
                                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium cursor-pointer transition-colors"
                                :class="adminSubView === 'dashboard' ? 'bg-siga-blue-dark text-white' : 'text-siga-text-light hover:bg-gray-50 hover:text-siga-blue-dark'"><i
                                    class="ri-dashboard-line text-lg"></i> Dashboard</a></li>
                        <li><a @click="changeAdminView('inscripciones')"
                                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium cursor-pointer transition-colors"
                                :class="adminSubView === 'inscripciones' ? 'bg-siga-blue-dark text-white' : 'text-siga-text-light hover:bg-gray-50 hover:text-siga-blue-dark'"><i
                                    class="ri-user-add-line text-lg"></i> Inscripciones</a></li>
                        <li><a @click="changeAdminView('alumnos')"
                                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium cursor-pointer transition-colors"
                                :class="adminSubView === 'alumnos' || adminSubView === 'detalle_alumno' ? 'bg-siga-blue-dark text-white' : 'text-siga-text-light hover:bg-gray-50 hover:text-siga-blue-dark'"><i
                                    class="ri-group-line text-lg"></i> Alumnos</a></li>
                        <li><a @click="changeAdminView('docentes')"
                                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium cursor-pointer transition-colors"
                                :class="adminSubView === 'docentes' ? 'bg-siga-blue-dark text-white' : 'text-siga-text-light hover:bg-gray-50 hover:text-siga-blue-dark'"><i
                                    class="ri-presentation-line text-lg"></i> Docentes</a></li>
                        <li><a @click="changeAdminView('carreras')"
                                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium cursor-pointer transition-colors"
                                :class="adminSubView === 'carreras' || adminSubView === 'detalle_carrera' ? 'bg-siga-blue-dark text-white' : 'text-siga-text-light hover:bg-gray-50 hover:text-siga-blue-dark'"><i
                                    class="ri-honour-line text-lg"></i> Carreras</a></li>
                        <li><a @click="changeAdminView('certificados')"
                                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium cursor-pointer transition-colors"
                                :class="adminSubView === 'certificados' ? 'bg-siga-blue-dark text-white' : 'text-siga-text-light hover:bg-gray-50 hover:text-siga-blue-dark'"><i
                                    class="ri-file-paper-2-line text-lg"></i> Certificados</a></li>
                        <li><a @click="changeAdminView('configuracion')"
                                class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium cursor-pointer transition-colors"
                                :class="adminSubView === 'configuracion' ? 'bg-siga-blue-dark text-white' : 'text-siga-text-light hover:bg-gray-50 hover:text-siga-blue-dark'"><i
                                    class="ri-settings-4-line text-lg"></i> Configuración</a></li>
                    </template>
                    <template v-if="['alumno', 'docente'].includes(rolSeleccionado)">
                        <li><a
                                class="flex items-center gap-3 px-4 py-3 rounded-lg bg-siga-blue-dark text-white font-medium cursor-pointer"><i
                                    class="ri-dashboard-line text-lg"></i> Panel Principal</a></li>
                        <li><a
                                class="flex items-center gap-3 px-4 py-3 rounded-lg text-siga-text-light hover:bg-gray-50 hover:text-siga-blue-dark transition-colors font-medium cursor-pointer"><i
                                    class="ri-calendar-event-line text-lg"></i> Cronograma</a></li>
                    </template>
                </ul>
                <div class="p-4 border-t border-gray-200 flex items-center gap-3 mt-auto bg-white">
                    <div
                        class="w-9 h-9 rounded-full bg-siga-orange text-white flex items-center justify-center font-bold shadow-sm shrink-0">
                        {{ userInitial }}</div>
                    <div class="flex-1 min-w-0">
                        <div class="text-sm font-bold text-siga-text-dark truncate capitalize">{{ currentUser.nombre }}
                        </div>
                        <!-- Texto condicional -->
                        <div class="text-xs text-siga-text-light">{{ rolSeleccionado === 'aspirante' ? 'Volver al
                            Inicio' : 'Cerrar Sesión' }}</div>
                    </div>

                    <!-- Botón para Aspirante (Azul, Icono Flecha) -->
                    <button v-if="rolSeleccionado === 'aspirante'" @click="logout()"
                        class="text-siga-blue-mid hover:bg-blue-50 p-2 rounded-lg transition-colors" title="Volver">
                        <i class="ri-arrow-left-circle-line text-2xl"></i>
                    </button>

                    <!-- Botón para Usuarios (Rojo, Icono Logout) -->
                    <button v-else @click="logout()"
                        class="text-siga-danger hover:bg-red-50 p-2 rounded-lg transition-colors" title="Salir">
                        <i class="ri-logout-box-line text-lg"></i>
                    </button>
                </div>
            </aside>

            <!-- MAIN -->
            <main class="flex-1 flex flex-col min-w-0 bg-siga-bg relative z-0 h-full">
                <!-- TOPBAR -->
                <div
                    class="h-[70px] bg-white border-b border-gray-200 flex items-center justify-between px-4 lg:px-8 shrink-0 sticky top-0 z-30 shadow-sm lg:shadow-none">
                    <div class="flex items-center gap-4">
                        <button @click="mobileMenuOpen = !mobileMenuOpen"
                            class="lg:hidden text-siga-blue-dark text-2xl p-1 focus:outline-none hover:bg-gray-100 rounded transition-colors"><i
                                class="ri-menu-line"></i></button>
                        <h3 class="text-siga-blue-dark font-bold text-lg m-0 truncate">{{ pageTitle }}</h3>
                    </div>
                    <div class="text-sm text-siga-text-light flex items-center gap-1"><i class="ri-calendar-line"></i>
                        <span class="hidden sm:inline">Hoy</span>
                    </div>
                </div>

                <div class="flex-1 overflow-y-auto p-4 lg:p-8 scroll-smooth">

                    <!-- ASPIRANTE FORM -->
                    <div v-if="rolSeleccionado === 'aspirante'" class="animate-fade-in-up">
                        <div v-if="!aspiranteEnviado"
                            class="bg-white rounded-xl p-8 shadow-sm max-w-[800px] mx-auto mb-10 border border-gray-100">
                            <div class="border-b border-gray-100 pb-5 mb-6">
                                <h2 class="text-2xl font-brand font-bold text-siga-blue-dark m-0">Legajo Digital 2026
                                </h2>
                                <p class="text-siga-text-light text-sm mt-1">Complete la información requerida para
                                    formalizar su preinscripción.</p>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div><label class="block text-sm font-semibold text-siga-text-dark mb-1">Nombre <span
                                            class="text-siga-danger">*</span></label><input v-model="aspForm.nombre"
                                        type="text"
                                        class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:border-siga-blue-mid"
                                        :class="{'border-siga-danger bg-siga-danger-light': errors.nombre}"
                                        @input="errors.nombre = null" placeholder="Sus nombres"><span
                                        v-if="errors.nombre" class="text-siga-danger text-xs mt-1 block font-medium">{{
                                        errors.nombre }}</span></div>
                                <div><label class="block text-sm font-semibold text-siga-text-dark mb-1">Apellido <span
                                            class="text-siga-danger">*</span></label><input v-model="aspForm.apellido"
                                        type="text"
                                        class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:border-siga-blue-mid"
                                        :class="{'border-siga-danger bg-siga-danger-light': errors.apellido}"
                                        @input="errors.apellido = null" placeholder="Sus apellidos"><span
                                        v-if="errors.apellido"
                                        class="text-siga-danger text-xs mt-1 block font-medium">{{ errors.apellido
                                        }}</span></div>
                                <div class="md:col-span-2"><label
                                        class="block text-sm font-semibold text-siga-text-dark mb-1">DNI <span
                                            class="text-siga-danger">*</span></label><input v-model="aspForm.dni"
                                        type="number"
                                        class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:border-siga-blue-mid"
                                        :class="{'border-siga-danger bg-siga-danger-light': errors.dni}"
                                        @input="errors.dni = null" placeholder="Número de documento sin puntos"><span
                                        v-if="errors.dni" class="text-siga-danger text-xs mt-1 block font-medium">{{
                                        errors.dni }}</span></div>
                                <div class="md:col-span-2"><label
                                        class="block text-sm font-semibold text-siga-text-dark mb-1">Correo Electrónico
                                        <span class="text-siga-danger">*</span></label>
                                    <div class="flex gap-3"><input v-model="aspForm.email" type="email"
                                            class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:border-siga-blue-mid"
                                            placeholder="ejemplo@gmail.com"><button @click="validarEmail"
                                            :disabled="estadoEmail !== 'idle'"
                                            class="bg-siga-blue-mid text-white border-none px-6 rounded-lg cursor-pointer font-medium hover:bg-siga-blue-dark disabled:bg-gray-400 transition-colors"><span
                                                v-if="estadoEmail === 'idle'">Validar</span><span
                                                v-if="estadoEmail === 'loading'"><i
                                                    class="ri-loader-4-line animate-spin"></i></span><span
                                                v-if="estadoEmail === 'sent'"><i
                                                    class="ri-check-line"></i></span></button></div><span
                                        v-if="errors.email" class="text-siga-danger text-xs mt-1 block font-medium">{{
                                        errors.email }}</span>
                                </div>
                                <div class="md:col-span-2 animate-fade-in-up" v-if="mostrarInputCodigo"><label
                                        class="block text-sm font-semibold text-siga-blue-mid mb-1">Código de
                                        Verificación (123456)</label><input v-model="aspForm.codigo" type="text"
                                        class="w-full p-3 border border-siga-blue-mid rounded-lg bg-blue-50 focus:outline-none"
                                        :class="{'border-siga-danger bg-siga-danger-light': errors.codigo}"
                                        @input="errors.codigo = null" placeholder="Ingrese el código recibido"><span
                                        v-if="errors.codigo" class="text-siga-danger text-xs mt-1 block font-medium">{{
                                        errors.codigo }}</span></div>
                                <div class="md:col-span-2"><label
                                        class="block text-sm font-semibold text-siga-text-dark mb-1">Carrera
                                        Seleccionada <span class="text-siga-danger">*</span></label><select
                                        v-model="aspForm.carrera"
                                        class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:border-siga-blue-mid">
                                        <option value="">Seleccione una opción...</option>
                                        <option>Tecnicatura Sup. en Desarrollo de Software</option>
                                        <option>Tecnicatura Sup. en Administración</option>
                                    </select></div>
                                <div><label class="block text-sm font-semibold text-siga-text-dark mb-1">DNI Frente
                                        <span class="text-siga-danger">*</span></label><input type="file"
                                        ref="fileInputFrontal" class="hidden" accept=".pdf,.doc,.docx,.jpg,.png"
                                        @change="seleccionarDniFrontal">
                                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer bg-gray-50 hover:border-siga-blue-mid transition-all group"
                                        :class="{'border-siga-success bg-green-50': archivoDniFrontal, 'border-siga-danger bg-red-50': errors.fileFrontal}"
                                        @click="triggerDniFrontal">
                                        <div v-if="!archivoDniFrontal"><i
                                                class="ri-id-card-line text-4xl text-gray-400 group-hover:text-siga-blue-mid"></i>
                                            <p class="mt-2 text-sm font-medium text-siga-text-light">Subir Frente</p>
                                        </div>
                                        <div v-else><i class="ri-check-line text-4xl text-siga-success"></i>
                                            <p class="mt-2 text-sm font-bold text-siga-text-dark truncate">{{
                                                archivoDniFrontal }}</p>
                                        </div>
                                    </div><span v-if="errors.fileFrontal"
                                        class="text-siga-danger text-xs mt-1 block font-medium">{{ errors.fileFrontal
                                        }}</span>
                                </div>
                                <div><label class="block text-sm font-semibold text-siga-text-dark mb-1">DNI Dorso <span
                                            class="text-siga-danger">*</span></label><input type="file"
                                        ref="fileInputDorso" class="hidden" accept=".pdf,.doc,.docx,.jpg,.png"
                                        @change="seleccionarDniDorso">
                                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer bg-gray-50 hover:border-siga-blue-mid transition-all group"
                                        :class="{'border-siga-success bg-green-50': archivoDniDorso, 'border-siga-danger bg-red-50': errors.fileDorso}"
                                        @click="triggerDniDorso">
                                        <div v-if="!archivoDniDorso"><i
                                                class="ri-id-card-line text-4xl text-gray-400 group-hover:text-siga-blue-mid"></i>
                                            <p class="mt-2 text-sm font-medium text-siga-text-light">Subir Dorso</p>
                                        </div>
                                        <div v-else><i class="ri-check-line text-4xl text-siga-success"></i>
                                            <p class="mt-2 text-sm font-bold text-siga-text-dark truncate">{{
                                                archivoDniDorso }}</p>
                                        </div>
                                    </div><span v-if="errors.fileDorso"
                                        class="text-siga-danger text-xs mt-1 block font-medium">{{ errors.fileDorso
                                        }}</span>
                                </div>
                                <div class="md:col-span-2"><label
                                        class="block text-sm font-semibold text-siga-text-dark mb-1">Título Secundario
                                        (Digital) <span class="text-siga-danger">*</span></label><input type="file"
                                        ref="fileInput" class="hidden" accept=".pdf,.doc,.docx,.jpg,.png"
                                        @change="seleccionarArchivo">
                                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer bg-gray-50 hover:border-siga-blue-mid transition-all group"
                                        :class="{'border-siga-success bg-green-50': archivoNombre, 'border-siga-danger bg-red-50': errors.file}"
                                        @click="triggerFileInput">
                                        <div v-if="!archivoNombre"><i
                                                class="ri-upload-cloud-2-line text-4xl text-gray-400 group-hover:text-siga-blue-mid"></i>
                                            <p class="mt-2 text-sm font-medium text-siga-text-light">Haga clic para
                                                subir o arrastre el archivo aquí</p>
                                        </div>
                                        <div v-else><i class="ri-file-text-line text-4xl text-siga-success"></i>
                                            <p class="mt-2 text-sm font-bold text-siga-text-dark">{{ archivoNombre }}
                                            </p>
                                        </div>
                                    </div><span v-if="errors.file"
                                        class="text-siga-danger text-xs mt-1 block font-medium">{{ errors.file }}</span>
                                </div>
                                <div class="md:col-span-2">
                                    <div class="bg-gray-50 border border-gray-300 rounded-md w-fit p-3 pr-6 flex items-center gap-4 shadow-sm select-none"
                                        :class="{'border-siga-danger bg-red-50': errors.captcha}">
                                        <div class="w-7 h-7 border-2 border-gray-400 rounded bg-white cursor-pointer flex items-center justify-center transition-colors hover:border-gray-500"
                                            :class="{'border-transparent': captchaChecked}" @click="toggleCaptcha"><i
                                                v-if="captchaChecked"
                                                class="ri-check-line text-siga-success text-2xl animate-pulse-blue"></i>
                                        </div><span class="text-sm font-medium text-siga-text-dark">No soy un
                                            robot</span>
                                        <div class="ml-4 flex flex-col items-center justify-center text-gray-500"><i
                                                class="ri-shield-star-line text-2xl"></i><span
                                                class="text-[8px] leading-none mt-0.5">reCAPTCHA</span></div>
                                    </div><span v-if="errors.captcha"
                                        class="text-siga-danger text-xs mt-1 block font-medium">{{ errors.captcha
                                        }}</span>
                                </div>
                                <div class="md:col-span-2"><button @click="validarAspirante"
                                        class="w-full mt-4 p-4 bg-siga-orange text-white rounded-lg font-bold text-base hover:bg-orange-600 hover:-translate-y-px transition-all shadow-md flex justify-center items-center gap-2">CONFIRMAR
                                        INSCRIPCIÓN</button></div>
                            </div>
                        </div>
                        <div v-else
                            class="bg-white rounded-xl p-12 shadow-sm max-w-[800px] mx-auto mb-10 text-center border border-gray-100 animate-fade-in-up">
                            <div
                                class="w-24 h-24 bg-siga-success/10 text-siga-success rounded-full flex items-center justify-center text-6xl mx-auto mb-6 shadow-sm">
                                <i class="ri-check-line"></i>
                            </div>
                            <h2 class="text-3xl font-brand font-bold text-siga-blue-dark mb-3">¡Inscripción Exitosa!
                            </h2>
                            <p class="text-lg text-siga-text-light mb-10">Tus datos han sido registrados correctamente.
                            </p>
                            <div
                                class="bg-blue-50 border border-blue-100 text-siga-blue-dark p-6 rounded-xl mb-10 text-left flex gap-5 items-start">
                                <div class="bg-white p-2 rounded-full shadow-sm text-siga-blue-mid"><i
                                        class="ri-mail-send-line text-2xl"></i></div>
                                <div><strong class="block text-lg mb-1">Próximos pasos:</strong><span
                                        class="text-sm opacity-90 leading-relaxed">Cuando se termine el proceso de
                                        validación, enviaremos un mensaje a <strong>{{ aspForm.email }}</strong>.</span>
                                </div>
                            </div><button @click="logout()"
                                class="bg-siga-blue-dark text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-900 transition-colors shadow-md">Volver
                                al Inicio</button>
                        </div>
                    </div>

                    <!-- ADMIN (Secretaría) -->
                    <div v-if="rolSeleccionado === 'admin'" class="animate-fade-in-up">

                        <!-- DASHBOARD -->
                        <div v-if="adminSubView === 'dashboard'">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                                <div @click="changeAdminView('inscripciones')"
                                    class="bg-white p-5 rounded-xl shadow-sm border-b-4 border-siga-orange flex flex-col cursor-pointer transition-transform hover:-translate-y-1 group">
                                    <div class="flex justify-between items-start mb-2"><span
                                            class="text-xs font-bold text-siga-text-light uppercase group-hover:text-siga-orange transition-colors">Inscripciones
                                            Pendientes</span><i
                                            class="ri-user-add-line text-2xl opacity-50 text-siga-blue-light"></i></div>
                                    <div class="text-3xl font-extrabold text-siga-blue-dark">{{ pendingCount }}</div>
                                </div>
                                <div @click="changeAdminView('alumnos')"
                                    class="bg-white p-5 rounded-xl shadow-sm border-b-4 border-siga-blue-mid flex flex-col cursor-pointer transition-transform hover:-translate-y-1 group">
                                    <div class="flex justify-between items-start mb-2"><span
                                            class="text-xs font-bold text-siga-text-light uppercase group-hover:text-siga-blue-mid transition-colors">Matrícula</span><i
                                            class="ri-group-line text-2xl opacity-50 text-siga-blue-light"></i></div>
                                    <div class="text-3xl font-extrabold text-siga-blue-dark">{{ approvedCount }}</div>
                                </div>
                                <div @click="changeAdminView('docentes')"
                                    class="bg-white p-5 rounded-xl shadow-sm border-b-4 border-purple-500 flex flex-col cursor-pointer transition-transform hover:-translate-y-1 group">
                                    <div class="flex justify-between items-start mb-2"><span
                                            class="text-xs font-bold text-siga-text-light uppercase group-hover:text-purple-600 transition-colors">Plantel
                                            Docente</span><i
                                            class="ri-presentation-line text-2xl opacity-50 text-purple-400"></i></div>
                                    <div class="text-3xl font-extrabold text-siga-blue-dark">{{ docentesCount }}</div>
                                </div>
                                <div @click="changeAdminView('carreras')"
                                    class="bg-white p-5 rounded-xl shadow-sm border-b-4 border-teal-500 flex flex-col cursor-pointer transition-transform hover:-translate-y-1 group">
                                    <div class="flex justify-between items-start mb-2"><span
                                            class="text-xs font-bold text-siga-text-light uppercase group-hover:text-teal-600 transition-colors">Oferta
                                            Académica</span><i
                                            class="ri-honour-line text-2xl opacity-50 text-teal-400"></i></div>
                                    <div class="text-3xl font-extrabold text-siga-blue-dark">{{ carrerasCount }}</div>
                                </div>
                                <div class="bg-white rounded-xl shadow-sm flex flex-col overflow-hidden relative">
                                    <div class="p-5 pb-2">
                                        <div class="flex justify-between items-start mb-2"><span
                                                class="text-xs font-bold text-siga-text-light uppercase">SAGE</span><i
                                                class="ri-refresh-line text-2xl text-siga-success"></i></div>
                                        <div class="text-3xl font-extrabold text-siga-success">ONLINE</div>
                                    </div>
                                    <div class="absolute bottom-0 left-0 h-1.5 bg-siga-success transition-all duration-100"
                                        :style="{ width: timerProgress + '%' }"></div>
                                </div>
                                <div class="bg-white rounded-xl shadow-sm flex flex-col overflow-hidden relative">
                                    <div class="p-5 pb-2">
                                        <div class="flex justify-between items-start mb-2"><span
                                                class="text-xs font-bold text-siga-text-light uppercase">Moodle</span><i
                                                class="ri-server-line text-2xl opacity-50 text-siga-blue-light"></i>
                                        </div>
                                        <div class="text-3xl font-extrabold text-siga-blue-mid">ACTIVO</div>
                                    </div>
                                    <div class="absolute bottom-0 left-0 h-1.5 bg-siga-blue-mid transition-all duration-100"
                                        :style="{ width: timerProgress + '%' }"></div>
                                </div>
                            </div>
                        </div>

                        <!-- INSCRIPCIONES (MODIFICADO CON 4 CÍRCULOS) -->
                        <div v-if="adminSubView === 'inscripciones'">
                            <div
                                class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden mb-8 animate-fade-in-up">
                                <div
                                    class="p-6 flex flex-wrap gap-4 justify-between items-center border-b border-gray-100">
                                    <h3 class="text-lg font-bold text-siga-blue-dark flex items-center gap-2 m-0"><i
                                            class="ri-history-line"></i> Listado de Inscripciones</h3>
                                    <div class="flex gap-3 w-full md:w-auto">
                                        <div class="relative"><select v-model="adminFilterEstado"
                                                class="appearance-none pl-4 pr-10 py-2 border border-gray-200 rounded-full text-sm focus:outline-none bg-white text-gray-600 cursor-pointer">
                                                <option value="">Todos los Estados</option>
                                                <option value="Pendiente">Pendientes</option>
                                                <option value="Aprobado">Aprobados</option>
                                                <option value="Procesando">Procesando</option>
                                            </select><i
                                                class="ri-filter-3-line absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
                                        </div>
                                        <div class="relative w-full md:w-72"><i
                                                class="ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i><input
                                                v-model="adminSearch" type="text"
                                                class="w-full pl-9 pr-4 py-2 border border-gray-200 rounded-full text-sm focus:outline-none transition-all"
                                                placeholder="Buscar por DNI o Apellido..."></div>
                                    </div>
                                </div>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm text-left border-collapse">
                                        <thead class="bg-siga-bg text-siga-text-light uppercase text-xs font-semibold">
                                            <tr>
                                                <th @click="ordenar('fechaSolicitud')"
                                                    class="px-6 py-4 cursor-pointer hover:text-blue-600 select-none">
                                                    Fecha <i v-if="ordenCol === 'fechaSolicitud'"
                                                        :class="ordenAsc ? 'ri-arrow-up-s-line' : 'ri-arrow-down-s-line'"></i>
                                                </th>
                                                <th @click="ordenar('dni')"
                                                    class="px-6 py-4 cursor-pointer hover:text-blue-600 select-none">DNI
                                                    <i v-if="ordenCol === 'dni'"
                                                        :class="ordenAsc ? 'ri-arrow-up-s-line' : 'ri-arrow-down-s-line'"></i>
                                                </th>
                                                <th @click="ordenar('nombre')"
                                                    class="px-6 py-4 cursor-pointer hover:text-blue-600 select-none">
                                                    Aspirante <i v-if="ordenCol === 'nombre'"
                                                        :class="ordenAsc ? 'ri-arrow-up-s-line' : 'ri-arrow-down-s-line'"></i>
                                                </th>
                                                <th @click="ordenar('carrera')"
                                                    class="px-6 py-4 cursor-pointer hover:text-blue-600 select-none">
                                                    Carrera <i v-if="ordenCol === 'carrera'"
                                                        :class="ordenAsc ? 'ri-arrow-up-s-line' : 'ri-arrow-down-s-line'"></i>
                                                </th>
                                                <th class="px-6 py-4 text-center">Estado</th>
                                                <th class="px-6 py-4">Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-100">
                                            <tr v-for="sol in adminPaginatedData" :key="sol.id"
                                                class="hover:bg-gray-50">
                                                <td class="px-6 py-4 whitespace-nowrap text-gray-500">{{
                                                    sol.fechaSolicitud }}</td>
                                                <td class="px-6 py-4 font-mono font-semibold text-gray-700">{{ sol.dni
                                                    }}</td>
                                                <td class="px-6 py-4">
                                                    <div class="font-bold text-siga-blue-dark">{{ sol.nombre }}</div>
                                                    <div class="text-xs text-gray-500">{{ sol.email }}</div>
                                                </td>
                                                <td class="px-6 py-4"><span
                                                        class="px-3 py-1 bg-gray-100 rounded-full text-xs font-bold">{{
                                                        sol.carrera }}</span></td>
                                                <td class="px-6 py-4 min-w-[220px] text-center">
                                                    <div class="flex flex-col items-center gap-2">
                                                        <span v-if="sol.estado === 'Pendiente'"
                                                            class="px-3 py-1 rounded-full text-xs font-bold uppercase bg-yellow-100 text-yellow-700">Pendiente</span>
                                                        <span v-else-if="sol.estado === 'Aprobado'"
                                                            class="px-3 py-1 rounded-full text-xs font-bold uppercase bg-green-100 text-green-700">Inscripto</span>
                                                        <span v-else
                                                            class="px-3 py-1 rounded-full text-xs font-bold uppercase bg-blue-100 text-blue-700"><i
                                                                class="ri-loader-4-line animate-spin"></i>
                                                            Validando</span>
                                                        <div class="flex items-center gap-3 mt-1 justify-center">
                                                            <div class="async-node-wrapper"
                                                                data-label="Guardado Base de Datos">
                                                                <div class="w-7 h-7 rounded-full border-2 flex items-center justify-center text-xs transition-all"
                                                                    :class="getNodeClass(sol.pasos.db)"><i
                                                                        :class="getNodeIcon(sol.pasos.db)"></i></div>
                                                            </div>
                                                            <div class="async-node-wrapper" data-label="Alta en Moodle">
                                                                <div class="w-7 h-7 rounded-full border-2 flex items-center justify-center text-xs transition-all"
                                                                    :class="getNodeClass(sol.pasos.moodle)"><i
                                                                        :class="getNodeIcon(sol.pasos.moodle)"></i>
                                                                </div>
                                                            </div>
                                                            <div class="async-node-wrapper"
                                                                data-label="Sincronización SAGE">
                                                                <div class="w-7 h-7 rounded-full border-2 flex items-center justify-center text-xs transition-all"
                                                                    :class="getNodeClass(sol.pasos.sage)"><i
                                                                        :class="getNodeIcon(sol.pasos.sage)"></i></div>
                                                            </div>
                                                            <!-- Paso Email (NUEVO) -->
                                                            <div class="async-node-wrapper"
                                                                data-label="Notificación Email">
                                                                <div class="w-7 h-7 rounded-full border-2 flex items-center justify-center text-xs transition-all"
                                                                    :class="getNodeClass(sol.pasos.email)"><i
                                                                        :class="getNodeIcon(sol.pasos.email)"></i></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td class="px-6 py-4">
                                                    <button v-if="sol.estado === 'Pendiente'" @click="procesar(sol.id)"
                                                        :disabled="sol.estado === 'Procesando'"
                                                        class="bg-siga-blue-dark text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-siga-blue-mid">Validar</button>
                                                    <button v-if="sol.estado === 'Aprobado'"
                                                        @click="verDetalleInscripcion(sol)"
                                                        class="border border-gray-300 px-3 py-1.5 rounded text-xs font-bold hover:border-siga-blue-mid text-gray-600">Detalle</button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="p-4 border-t border-gray-200 flex justify-between items-center"><span
                                        class="text-xs text-gray-500">Mostrando {{ adminPaginatedData.length }}
                                        registros</span>
                                    <div class="flex gap-2"><button @click="adminPage--" :disabled="adminPage === 1"
                                            class="px-3 py-1 border rounded text-sm disabled:opacity-50 hover:border-siga-blue-mid">Anterior</button><button
                                            class="px-3 py-1 bg-siga-blue-dark text-white rounded text-sm">{{ adminPage
                                            }}</button><button @click="adminPage++"
                                            :disabled="adminPaginatedData.length < adminItemsPerPage"
                                            class="px-3 py-1 border rounded text-sm disabled:opacity-50 hover:border-siga-blue-mid">Siguiente</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ALUMNOS -->
                        <div v-if="adminSubView === 'alumnos'" class="animate-fade-in-up">
                            <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden mb-8">
                                <div class="p-6 border-b border-gray-100">
                                    <h3 class="text-lg font-bold text-siga-blue-dark flex items-center gap-2 m-0"><i
                                            class="ri-group-line"></i> Matrícula de Alumnos</h3>
                                </div>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm text-left border-collapse">
                                        <thead class="bg-siga-bg text-siga-text-light uppercase text-xs font-semibold">
                                            <tr>
                                                <th class="px-6 py-4">Legajo</th>
                                                <th class="px-6 py-4">DNI</th>
                                                <th class="px-6 py-4">Alumno</th>
                                                <th class="px-6 py-4">Carrera</th>
                                                <th class="px-6 py-4">Cohorte</th>
                                                <th class="px-6 py-4">Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-100">
                                            <tr v-for="alumno in alumnosList" :key="alumno.id" class="hover:bg-gray-50">
                                                <td class="px-6 py-4 font-mono text-gray-500">#{{ alumno.id }}</td>
                                                <td class="px-6 py-4 font-mono font-semibold">{{ alumno.dni }}</td>
                                                <td class="px-6 py-4">
                                                    <div class="font-bold text-siga-blue-dark">{{ alumno.nombre }}</div>
                                                    <div class="text-xs text-gray-500">{{ alumno.email }}</div>
                                                </td>
                                                <td class="px-6 py-4"><span
                                                        class="px-3 py-1 bg-gray-100 rounded-full text-xs font-bold">{{
                                                        alumno.carrera }}</span></td>
                                                <td class="px-6 py-4">2025</td>
                                                <td class="px-6 py-4"><button @click="openStudentLegajo(alumno)"
                                                        class="text-siga-blue-mid hover:text-siga-blue-dark font-semibold text-xs flex items-center gap-1"><i
                                                            class="ri-profile-line"></i> Ver Legajo</button></td>
                                            </tr>
                                            <tr v-if="alumnosList.length === 0">
                                                <td colspan="6" class="px-6 py-8 text-center text-gray-500 italic">No
                                                    hay alumnos inscriptos aún.</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- VISTA DETALLE ALUMNO -->
                        <div v-if="adminSubView === 'detalle_alumno' && selectedStudent" class="animate-fade-in-up">
                            <div class="mb-6 flex items-center gap-4">
                                <button @click="changeAdminView('alumnos')"
                                    class="w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center text-gray-500 hover:text-siga-blue-dark hover:bg-gray-50 transition-colors"><i
                                        class="ri-arrow-left-line text-xl"></i></button>
                                <div>
                                    <h2 class="text-2xl font-bold text-siga-blue-dark m-0">{{ selectedStudent.nombre }}
                                    </h2>
                                    <span class="text-sm text-gray-500 font-mono">Legajo #{{ selectedStudent.id
                                        }}</span>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                <!-- Columna Izquierda -->
                                <div class="lg:col-span-1 space-y-6">
                                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 text-center">
                                        <div
                                            class="w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-4xl font-bold text-siga-blue-mid border-4 border-white shadow-md mx-auto mb-4">
                                            {{ selectedStudent.nombre.charAt(0) }}
                                        </div>
                                        <h3 class="font-bold text-lg text-siga-blue-dark">{{ selectedStudent.nombre }}
                                        </h3>
                                        <p class="text-sm text-gray-500 mb-6">{{ selectedStudent.email }}</p>

                                        <div class="text-left space-y-3">
                                            <div class="flex justify-between border-b border-gray-50 pb-2">
                                                <span class="text-xs font-bold text-gray-400 uppercase">DNI</span>
                                                <span class="font-mono font-semibold text-sm text-gray-700">{{
                                                    selectedStudent.dni }}</span>
                                            </div>
                                            <div class="flex justify-between border-b border-gray-50 pb-2">
                                                <span class="text-xs font-bold text-gray-400 uppercase">Teléfono</span>
                                                <span
                                                    class="font-mono font-semibold text-sm text-gray-700">299-1234567</span>
                                            </div>
                                            <div class="flex justify-between border-b border-gray-50 pb-2">
                                                <span class="text-xs font-bold text-gray-400 uppercase">Dirección</span>
                                                <span class="font-semibold text-sm text-gray-700">Calle Falsa 123</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Documentacion -->
                                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                        <h4 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><i
                                                class="ri-file-copy-2-line"></i> Documentación</h4>
                                        <div class="space-y-3">
                                            <div
                                                class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200">
                                                <div class="flex items-center gap-3">
                                                    <i class="ri-id-card-line text-xl text-siga-blue-mid"></i>
                                                    <span class="text-sm font-medium">DNI (Frente)</span>
                                                </div>
                                                <span
                                                    class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded font-bold">OK</span>
                                            </div>
                                            <div
                                                class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200">
                                                <div class="flex items-center gap-3">
                                                    <i class="ri-id-card-line text-xl text-siga-blue-mid"></i>
                                                    <span class="text-sm font-medium">DNI (Dorso)</span>
                                                </div>
                                                <span
                                                    class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded font-bold">OK</span>
                                            </div>
                                            <div
                                                class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200">
                                                <div class="flex items-center gap-3">
                                                    <i class="ri-file-paper-2-line text-xl text-siga-blue-mid"></i>
                                                    <span class="text-sm font-medium">Título Secundario</span>
                                                </div>
                                                <span
                                                    class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded font-bold">OK</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Columna Derecha -->
                                <div class="lg:col-span-2 space-y-6">
                                    <!-- Info Carrera -->
                                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                        <h4 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><i
                                                class="ri-graduation-cap-line"></i> Información Académica</h4>
                                        <div class="grid grid-cols-2 gap-6">
                                            <div>
                                                <span
                                                    class="block text-xs font-bold text-gray-400 uppercase mb-1">Carrera</span>
                                                <span class="text-siga-blue-mid font-bold">{{ selectedStudent.carrera
                                                    }}</span>
                                            </div>
                                            <div>
                                                <span
                                                    class="block text-xs font-bold text-gray-400 uppercase mb-1">Cohorte</span>
                                                <span class="font-mono font-semibold text-gray-700">2025</span>
                                            </div>
                                            <div>
                                                <span
                                                    class="block text-xs font-bold text-gray-400 uppercase mb-1">Promedio
                                                    General</span>
                                                <span class="font-mono font-bold text-gray-800">8.50</span>
                                            </div>
                                            <div>
                                                <span
                                                    class="block text-xs font-bold text-gray-400 uppercase mb-1">Estado</span>
                                                <span class="text-siga-success font-bold">Regular</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Cursada Actual -->
                                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                        <h4 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><i
                                                class="ri-book-open-line"></i> Cursada Actual</h4>
                                        <div
                                            v-if="selectedStudent.materiasInscriptas && selectedStudent.materiasInscriptas.length > 0">
                                            <table class="w-full text-sm text-left">
                                                <thead class="bg-gray-50 text-gray-500 uppercase text-xs">
                                                    <tr>
                                                        <th class="px-4 py-2">Materia</th>
                                                        <th class="px-4 py-2">Condición</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="divide-y divide-gray-100">
                                                    <tr v-for="(mat, idx) in selectedStudent.materiasInscriptas"
                                                        :key="idx">
                                                        <td class="px-4 py-3 font-medium text-gray-700">{{ mat }}</td>
                                                        <td class="px-4 py-3 text-siga-blue-mid font-semibold">Cursando
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div v-else class="text-sm text-gray-400 italic">No cursa materias actualmente.
                                        </div>
                                    </div>

                                    <!-- Historial Finales -->
                                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                        <h4 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><i
                                                class="ri-history-line"></i> Historial de Finales</h4>
                                        <table class="w-full text-sm text-left">
                                            <thead class="bg-gray-50 text-gray-500 uppercase text-xs">
                                                <tr>
                                                    <th class="px-4 py-2">Fecha</th>
                                                    <th class="px-4 py-2">Materia</th>
                                                    <th class="px-4 py-2">Nota</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-100">
                                                <tr>
                                                    <td class="px-4 py-3 font-mono text-xs text-gray-500">15/12/2024
                                                    </td>
                                                    <td class="px-4 py-3">Inglés Técnico I</td>
                                                    <td class="px-4 py-3 font-bold text-siga-success">9 (Nueve)</td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3 font-mono text-xs text-gray-500">18/12/2024
                                                    </td>
                                                    <td class="px-4 py-3">Matemática</td>
                                                    <td class="px-4 py-3 font-bold text-siga-success">8 (Ocho)</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- Certificados Pedidos -->
                                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                        <h4 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><i
                                                class="ri-file-paper-2-line"></i> Certificados Solicitados</h4>
                                        <div class="space-y-2">
                                            <div
                                                class="flex justify-between items-center bg-gray-50 p-3 rounded border border-gray-200">
                                                <div class="text-sm">
                                                    <span class="block font-bold text-gray-700">Alumno Regular</span>
                                                    <span class="text-xs text-gray-400">Solicitado el 10/03/2025</span>
                                                </div>
                                                <span
                                                    class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded font-bold">Entregado</span>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <!-- DOCENTES -->
                        <div v-if="adminSubView === 'docentes'" class="animate-fade-in-up">
                            <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden mb-8">
                                <div class="p-6 border-b border-gray-100 flex justify-between items-center">
                                    <h3 class="text-lg font-bold text-siga-blue-dark flex items-center gap-2 m-0"><i
                                            class="ri-presentation-line"></i> Plantel Docente</h3>
                                    <div class="flex gap-2">
                                        <button @click="openAssignDocente(false)"
                                            class="bg-white border border-gray-300 text-gray-600 px-4 py-2 rounded-lg text-sm font-bold hover:bg-gray-50 shadow-sm flex items-center gap-2"><i
                                                class="ri-link"></i> Asignar</button>
                                        <button @click="openAddDocente"
                                            class="bg-siga-orange text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-orange-600 shadow-sm flex items-center gap-2"><i
                                                class="ri-add-line"></i> Nuevo Docente</button>
                                    </div>
                                </div>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm text-left border-collapse">
                                        <thead class="bg-siga-bg text-siga-text-light uppercase text-xs font-semibold">
                                            <tr>
                                                <th class="px-6 py-4">Nombre</th>
                                                <th class="px-6 py-4">DNI</th>
                                                <th class="px-6 py-4">Email</th>
                                                <th class="px-6 py-4">Asignaciones</th>
                                                <th class="px-6 py-4">Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-100">
                                            <tr v-for="doc in docentesData" :key="doc.id" class="hover:bg-gray-50">
                                                <td class="px-6 py-4 font-bold text-siga-blue-dark">{{ doc.nombre }}
                                                </td>
                                                <td class="px-6 py-4 font-mono">{{ doc.dni }}</td>
                                                <td class="px-6 py-4 text-gray-500">{{ doc.email }}</td>
                                                <td class="px-6 py-4">
                                                    <div v-if="doc.asignaciones.length === 0"
                                                        class="text-xs text-gray-400 italic">Sin asignar</div>
                                                    <div v-else class="flex flex-col gap-1 items-start">
                                                        <span v-for="(asig, idx) in doc.asignaciones" :key="idx"
                                                            class="px-3 py-1 bg-gray-100 rounded-full text-xs font-bold text-gray-700">
                                                            {{ getMateriaName(asig.carreraId, asig.materiaId) }}
                                                        </span>
                                                    </div>
                                                </td>
                                                <td class="px-6 py-4 flex gap-2"><button
                                                        class="text-gray-400 hover:text-siga-blue-dark"><i
                                                            class="ri-pencil-line text-lg"></i></button><button
                                                        @click="deleteDocente(doc.id)"
                                                        class="text-gray-400 hover:text-siga-danger"><i
                                                            class="ri-delete-bin-line text-lg"></i></button></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- CARRERAS -->
                        <div v-if="adminSubView === 'carreras'" class="animate-fade-in-up">
                            <div class="grid grid-cols-1 gap-6">
                                <div v-for="carrera in carrerasData" :key="carrera.id"
                                    class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                                    <div class="p-6 border-b border-gray-100 flex justify-between items-start">
                                        <div>
                                            <h3 class="text-lg font-bold text-siga-blue-dark m-0">{{ carrera.nombre }}
                                            </h3><span class="text-sm text-gray-500">Duración: {{ carrera.duracion
                                                }}</span>
                                        </div>
                                        <div class="flex items-center gap-4">
                                            <div class="flex gap-4 text-sm mr-4">
                                                <div class="text-center">
                                                    <div class="font-bold text-siga-blue-mid text-lg">{{
                                                        getAlumnosCount(carrera.nombre) }}</div>
                                                    <div class="text-xs text-gray-400 uppercase">Alumnos</div>
                                                </div>
                                                <div class="text-center">
                                                    <div class="font-bold text-purple-600 text-lg">{{
                                                        getDocentesCount(carrera.id) }}</div>
                                                    <div class="text-xs text-gray-400 uppercase">Docentes</div>
                                                </div>
                                            </div>
                                            <button @click="openCareerDetail(carrera)"
                                                class="bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:text-siga-blue-dark px-4 py-2 rounded-lg text-sm font-bold transition-colors">Gestionar</button>
                                            <button @click="deleteCarrera(carrera.id)"
                                                class="text-gray-400 hover:text-siga-danger ml-2"><i
                                                    class="ri-delete-bin-line text-xl"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- DETALLE CARRERA -->
                        <div v-if="adminSubView === 'detalle_carrera' && selectedCarrera" class="animate-fade-in-up">
                            <div class="mb-6 flex items-center gap-4">
                                <button @click="changeAdminView('carreras')"
                                    class="w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center text-gray-500 hover:text-siga-blue-dark hover:bg-gray-50 transition-colors"><i
                                        class="ri-arrow-left-line text-xl"></i></button>
                                <div>
                                    <h2 class="text-2xl font-bold text-siga-blue-dark m-0">{{ selectedCarrera.nombre }}
                                    </h2><span class="text-sm text-gray-500">Panel de Gestión Académica</span>
                                </div>
                            </div>
                            <div class="flex gap-2 mb-6 border-b border-gray-200">
                                <button @click="careerTab = 'plan'"
                                    class="px-4 py-2 font-bold text-sm border-b-2 transition-colors"
                                    :class="careerTab === 'plan' ? 'border-siga-blue-mid text-siga-blue-mid' : 'border-transparent text-gray-500 hover:text-gray-700'">Plan
                                    de Estudios</button>
                                <button @click="careerTab = 'alumnos'"
                                    class="px-4 py-2 font-bold text-sm border-b-2 transition-colors"
                                    :class="careerTab === 'alumnos' ? 'border-siga-blue-mid text-siga-blue-mid' : 'border-transparent text-gray-500 hover:text-gray-700'">Alumnos
                                    Inscriptos</button>
                                <button @click="careerTab = 'docentes'"
                                    class="px-4 py-2 font-bold text-sm border-b-2 transition-colors"
                                    :class="careerTab === 'docentes' ? 'border-siga-blue-mid text-siga-blue-mid' : 'border-transparent text-gray-500 hover:text-gray-700'">Plantel
                                    Docente</button>
                            </div>

                            <!-- TAB: PLAN -->
                            <div v-if="careerTab === 'plan'"
                                class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 animate-fade-in">
                                <div class="flex justify-between items-center mb-6">
                                    <h4 class="text-lg font-bold text-gray-700 m-0">Materias del Plan</h4><button
                                        @click="openAddMateria"
                                        class="text-siga-blue-mid text-sm font-bold hover:underline flex items-center gap-1"><i
                                            class="ri-add-circle-line text-lg"></i> Agregar Materia</button>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <div v-for="(materia, idx) in selectedCarrera.materias" :key="materia.id"
                                        class="bg-gray-50 p-4 rounded-lg border border-gray-200 flex justify-between items-center hover:border-siga-blue-mid transition-colors group">
                                        <div class="flex flex-col"><span class="font-semibold text-gray-800">{{
                                                materia.n }}</span><span class="text-[10px] uppercase text-gray-400">{{
                                                materia.t }}</span>
                                            <div v-if="materia.correlativas.length > 0"
                                                class="flex flex-wrap gap-1 mt-1"><span
                                                    class="text-[9px] px-1 bg-yellow-100 text-yellow-700 rounded border border-yellow-200">Con
                                                    Correlativas</span></div>
                                        </div>
                                        <div class="flex gap-1"><button @click="openEditMateria(materia)"
                                                class="text-gray-300 hover:text-siga-blue-mid p-1"><i
                                                    class="ri-pencil-line text-lg"></i></button><button
                                                @click="deleteMateria(idx)"
                                                class="text-gray-300 hover:text-siga-danger p-1"><i
                                                    class="ri-delete-bin-line text-lg"></i></button></div>
                                    </div>
                                </div>
                            </div>

                            <!-- TAB: ALUMNOS -->
                            <div v-if="careerTab === 'alumnos'"
                                class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden animate-fade-in">
                                <table class="w-full text-sm text-left">
                                    <thead class="bg-gray-50 text-gray-500 uppercase text-xs">
                                        <tr>
                                            <th class="px-6 py-3">DNI</th>
                                            <th class="px-6 py-3">Nombre</th>
                                            <th class="px-6 py-3">Email</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-100">
                                        <tr v-for="al in filteredAlumnosByCareer" :key="al.id" class="hover:bg-gray-50">
                                            <td class="px-6 py-3 font-mono font-bold">{{ al.dni }}</td>
                                            <td class="px-6 py-3 text-siga-blue-dark font-semibold">{{ al.nombre }}</td>
                                            <td class="px-6 py-3 text-gray-500">{{ al.email }}</td>
                                        </tr>
                                        <tr v-if="filteredAlumnosByCareer.length === 0">
                                            <td colspan="3" class="p-6 text-center text-gray-500">No hay alumnos
                                                inscriptos en esta carrera.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- TAB: DOCENTES -->
                            <div v-if="careerTab === 'docentes'"
                                class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden p-6 animate-fade-in">
                                <div class="flex justify-between items-center mb-4">
                                    <h4 class="text-lg font-bold text-gray-700 m-0">Asignaciones Docentes</h4><button
                                        @click="openAssignDocente(true)"
                                        class="bg-siga-blue-mid text-white px-3 py-1.5 rounded text-xs font-bold hover:bg-blue-600 shadow-sm flex items-center gap-1"><i
                                            class="ri-user-add-line"></i> Asignar Profesor</button>
                                </div>
                                <table class="w-full text-sm text-left border-collapse">
                                    <thead class="bg-gray-50 text-gray-500 uppercase text-xs">
                                        <tr>
                                            <th class="px-4 py-3">Docente</th>
                                            <th class="px-4 py-3">Materia</th>
                                            <th class="px-4 py-3">Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-gray-100">
                                        <tr v-for="item in getDocentesAssignedToCareer(selectedCarrera.id)"
                                            :key="item.docente.id + '-' + item.materia.id" class="hover:bg-gray-50">
                                            <td class="px-4 py-3 font-bold text-siga-blue-dark">{{ item.docente.nombre
                                                }}</td>
                                            <td class="px-4 py-3">{{ item.materia.n }}</td>
                                            <td class="px-4 py-3"><button
                                                    @click="unassignDocente(item.docente.id, selectedCarrera.id, item.materia.id)"
                                                    class="text-red-400 hover:text-red-600 text-xs font-bold flex items-center gap-1"><i
                                                        class="ri-close-circle-line"></i> Quitar</button></td>
                                        </tr>
                                        <tr v-if="getDocentesAssignedToCareer(selectedCarrera.id).length === 0">
                                            <td colspan="3" class="p-6 text-center text-gray-500 italic">No hay docentes
                                                asignados.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- CERTIFICADOS VIEW -->
                        <div v-if="adminSubView === 'certificados'" class="animate-fade-in-up">
                            <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden mb-8">
                                <div class="p-6 border-b border-gray-100">
                                    <h3 class="text-lg font-bold text-siga-blue-dark flex items-center gap-2 m-0"><i
                                            class="ri-file-paper-2-line"></i> Emisión de Certificados</h3>
                                </div>
                                <div class="p-6 grid grid-cols-1 lg:grid-cols-3 gap-8">
                                    <!-- Selector Alumno -->
                                    <div class="lg:col-span-1 border-r border-gray-100 pr-6">
                                        <label class="block text-sm font-bold text-gray-700 mb-2">Buscar Alumno</label>
                                        <div class="relative mb-4">
                                            <i
                                                class="ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                            <input type="text" v-model="certSearch"
                                                class="w-full pl-9 pr-4 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:border-siga-blue-mid"
                                                placeholder="DNI o Apellido...">
                                        </div>
                                        <div class="max-h-96 overflow-y-auto space-y-2">
                                            <div v-for="al in filteredStudentsForCert" :key="al.id"
                                                @click="selectedStudentForCert = al"
                                                class="p-3 rounded-lg border cursor-pointer transition-colors"
                                                :class="selectedStudentForCert?.id === al.id ? 'bg-blue-50 border-siga-blue-mid' : 'bg-white border-gray-100 hover:bg-gray-50'">
                                                <div class="font-bold text-sm text-siga-text-dark">{{ al.nombre }}</div>
                                                <div class="text-xs text-gray-500 font-mono">{{ al.dni }}</div>
                                                <div class="text-[10px] text-siga-blue-mid mt-1">{{ al.carrera }}</div>
                                            </div>
                                            <div v-if="filteredStudentsForCert.length === 0"
                                                class="text-sm text-gray-400 italic text-center py-4">No se encontraron
                                                alumnos.</div>
                                        </div>
                                    </div>
                                    <!-- Tipos de Certificado -->
                                    <div class="lg:col-span-2">
                                        <div v-if="!selectedStudentForCert"
                                            class="h-full flex flex-col items-center justify-center text-gray-300">
                                            <i class="ri-user-search-line text-6xl mb-4"></i>
                                            <p>Seleccione un alumno para ver las opciones disponibles.</p>
                                        </div>
                                        <div v-else>
                                            <div class="flex items-center justify-between mb-6">
                                                <div>
                                                    <h4 class="font-bold text-lg text-siga-blue-dark">Certificados
                                                        Disponibles</h4>
                                                    <p class="text-sm text-gray-500">Para: <strong>{{
                                                            selectedStudentForCert.nombre }}</strong></p>
                                                </div>
                                                <button @click="selectedStudentForCert = null"
                                                    class="text-xs text-red-500 hover:underline">Cambiar Alumno</button>
                                            </div>

                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <button @click="generateCert('Alumno Regular')"
                                                    class="p-4 border border-gray-200 rounded-xl hover:border-siga-blue-mid hover:bg-blue-50 transition-all text-left group">
                                                    <div class="flex items-start gap-3">
                                                        <div
                                                            class="w-10 h-10 rounded-full bg-blue-100 text-siga-blue-mid flex items-center justify-center group-hover:bg-siga-blue-mid group-hover:text-white transition-colors">
                                                            <i class="ri-file-text-line text-xl"></i>
                                                        </div>
                                                        <div>
                                                            <span class="block font-bold text-siga-text-dark">Alumno
                                                                Regular</span>
                                                            <span class="text-xs text-gray-500">Constancia de
                                                                inscripción y regularidad.</span>
                                                        </div>
                                                    </div>
                                                </button>
                                                <button @click="generateCert('Analítico Parcial')"
                                                    class="p-4 border border-gray-200 rounded-xl hover:border-siga-blue-mid hover:bg-blue-50 transition-all text-left group">
                                                    <div class="flex items-start gap-3">
                                                        <div
                                                            class="w-10 h-10 rounded-full bg-green-100 text-siga-success flex items-center justify-center group-hover:bg-siga-success group-hover:text-white transition-colors">
                                                            <i class="ri-file-list-3-line text-xl"></i>
                                                        </div>
                                                        <div>
                                                            <span class="block font-bold text-siga-text-dark">Analítico
                                                                Parcial</span>
                                                            <span class="text-xs text-gray-500">Historial de materias y
                                                                notas.</span>
                                                        </div>
                                                    </div>
                                                </button>
                                                <button @click="generateCert('Constancia de Examen')"
                                                    class="p-4 border border-gray-200 rounded-xl hover:border-siga-blue-mid hover:bg-blue-50 transition-all text-left group">
                                                    <div class="flex items-start gap-3">
                                                        <div
                                                            class="w-10 h-10 rounded-full bg-orange-100 text-siga-orange flex items-center justify-center group-hover:bg-siga-orange group-hover:text-white transition-colors">
                                                            <i class="ri-time-line text-xl"></i>
                                                        </div>
                                                        <div>
                                                            <span class="block font-bold text-siga-text-dark">Constancia
                                                                de Examen</span>
                                                            <span class="text-xs text-gray-500">Para presentar en
                                                                trabajo.</span>
                                                        </div>
                                                    </div>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- CONFIGURACIÓN VIEW -->
                        <div v-if="adminSubView === 'configuracion'" class="animate-fade-in-up">
                            <div
                                class="max-w-2xl mx-auto bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                                <div class="p-6 border-b border-gray-100">
                                    <h3 class="text-lg font-bold text-siga-blue-dark flex items-center gap-2 m-0"><i
                                            class="ri-settings-4-line"></i> Configuración General</h3>
                                </div>
                                <div class="p-6 space-y-6">

                                    <!-- Periodo Inscripción -->
                                    <div>
                                        <h4
                                            class="text-sm font-bold text-gray-700 uppercase tracking-wide mb-4 border-l-4 border-siga-orange pl-3">
                                            Período de Inscripción 2026</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            <div>
                                                <label class="block text-xs font-bold text-gray-500 mb-1">Fecha de
                                                    Inicio</label>
                                                <input type="date" v-model="configData.inscripcionInicio"
                                                    class="w-full p-2 border rounded text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs font-bold text-gray-500 mb-1">Fecha de
                                                    Fin</label>
                                                <input type="date" v-model="configData.inscripcionFin"
                                                    class="w-full p-2 border rounded text-sm">
                                            </div>
                                        </div>
                                        <div
                                            class="flex items-center justify-between bg-gray-50 p-4 rounded-lg border border-gray-200">
                                            <div>
                                                <span class="block font-bold text-sm text-gray-700">Estado de
                                                    Inscripción</span>
                                                <span class="text-xs text-gray-500">{{ configData.inscripcionAbierta ?
                                                    'Actualmente se permiten nuevas solicitudes.' : 'El formulario de
                                                    inscripción está cerrado.' }}</span>
                                            </div>
                                            <!-- Toggle Switch -->
                                            <button
                                                @click="configData.inscripcionAbierta = !configData.inscripcionAbierta"
                                                class="w-12 h-6 rounded-full transition-colors relative focus:outline-none"
                                                :class="configData.inscripcionAbierta ? 'bg-siga-success' : 'bg-gray-300'">
                                                <div class="w-4 h-4 bg-white rounded-full absolute top-1 transition-transform"
                                                    :class="configData.inscripcionAbierta ? 'left-7' : 'left-1'"></div>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="pt-4 border-t border-gray-100 flex justify-end">
                                        <button @click="saveConfig"
                                            class="bg-siga-blue-mid text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-600 transition-colors shadow-sm">
                                            Guardar Cambios
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- ALUMNO/DOCENTE VIEW -->
                    <div v-if="['alumno', 'docente'].includes(rolSeleccionado)"
                        class="text-center mt-12 animate-fade-in-up">
                        <i class="ri-dashboard-3-line text-6xl text-siga-blue-light opacity-50"></i>
                        <h3 class="text-2xl text-siga-text-light mt-4">Bienvenido al Dashboard</h3>
                        <p class="text-gray-500">Perfil: <strong class="capitalize">{{ rolSeleccionado }}</strong></p>
                    </div>

                </div>
            </main>
        </div>

    </div>

    <script src="script.js"></script>
</body>

</html>